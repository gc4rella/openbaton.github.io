<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <title>OpenBaton Documentation</title>
  

  <link rel="shortcut icon" href="../favicon.ico">
  

  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:400italic,600italic,400,300,600,700" rel="stylesheet" type="text/css">

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Create a VIM Driver";
    var mkdocs_page_input_path = "vim-driver-create.md";
    var mkdocs_page_url = "/vim-driver-create/";
     var mkdocs_page_url = "/vim-driver-create/";
  </script>
  
  <!-- site_name == OpenBaton Documentation -->
  <!-- page_title == Create a VIM Driver -->
  <!-- base_url == .. -->
  <!-- current_page == Create a VIM Driver - /vim-driver-create/ [*]
 -->
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script>
  <script src="../js/theme.js"></script> 

  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-68429895-1', 'openbaton.github.io');
      ga('send', 'pageview');
  </script>
  

<style>

.subnav_drop{
  cursor: pointer;


}

ul.subnav {
/*display:none ;*/
cursor: pointer;
border-bottom: 1px solid #e1e1e5;
}

.subnav:last-child{
  border-bottom: none;

}

ul.subnav:active {
display:block;
}

.wy-menu-vertical li ul {
display: block;

  }

</style>
</head>

<body role="document">

<script type="text/javascript">
$( document).ready(function(){
      //console.log("test");

    //$('.subnav').not( ":has('Create a VIM Driver')" ).hide();
    $('li.subnav_drop').find('ul.subnav').hide();
    //$('li.subnav_drop').find('ul.subnav').each(function(i,e){console.log(i,e)});
       $( ".subnav" ).find( "li:contains('Create a VIM Driver')" ).each(function(i,e){
          var currentElement = $(e);
          currentElement.parent().css({"display":"block","visibility":"visible"}); //css("background-color","blue");
          currentElement.css({"display":"block","visibility":"visible"});
       });//$( ".subnav" ).find( "li:contains('Create a VIM Driver')" ).css("display","block");
       //$(".current").css({"background-color":"blue","display":"block","visibility":"visible"});
       //show(1000,function(i,e){console.log(i,e)});
       //$('li.subnav_drop').find('ul.subnav').css("background-color","blue");
      //$(this).find('ul.subnav').toggle();
    $('li.subnav_drop').click(function(i,e) {  
      $('li.subnav_drop').not(this).find('ul.subnav').hide();
      $(this).find('ul.subnav').toggle();
    }); 

});
   
$( ".wy-nav-content" ).find( "li:contains('Create a VIM Driver')" ).css('color','red');
console.log('--------');
console.log($( ".wy-nav-content" ).find( "div:contains('Create a VIM Driver')" ).css("color","red"));
console.log('--------');
console.log($( ".subnav" ).find( "li:contains('Create a VIM Driver')" ));
console.log('--------');
  </script>



<div class="navcontainer" style="margin:0px; background:#000;">
    <div class="navholder">
      <nav>
        <a href="../../index.html" class="logo"></a>
        <a href="#" id="menu-icon"></a>
        <ul class="navigation">
          
                <li><a href="../../index.html#about">About</a></li>
                <li><a href="../../cases.html">Use Cases</a></li>
                <li><a href="../../features.html">Features</a></li>
                <li><a href="#">Documentation</a></li>
                <li><a href="../../index.html#contact">Contact</a></li>
                <li><a href="http://marketplace.openbaton.org"><i class="material-icons">shopping_cart </i>  Marketplace<div class="ripple-container"></div></a></li>
          </ul>
      </nav>
     </div>
</div>
<div  class="container">
  <div class="holder"> 
        <div class="wy-grid-for-nav">

          
          <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
            <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
              <ul class="current">
                
		
                  <li><ul> 
    
   
    <li class="subnav_drop"><span>Get Started</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="..">Get Started</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
                 
		
		
                  <li><ul> 
    
   
    <li class="subnav_drop"><span>Installation</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../nfvo-installation/">Overview</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../nfvo-installation-deb/">Install on Linux</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../nfvo-installation-mac/">Install on MacOS</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../nfvo-installation-docker/">Install with Docker</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../nfvo-installation-vagrant/">Install with Vagrant</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../nfvo-configuration/">Configure it</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
                 
		
		
                  <li><ul> 
    
   
    <li class="subnav_drop"><span>NFV Orchestrator</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../use/">NFVO intro</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../security/">Identity management</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../nfvo-how-to-use-gui/">Use via the Dashboard</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../nfvo-how-to-use-cli/">Use via the CLI</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../vim-driver/">Install a VIM Driver</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../vim-instance/">Register a PoP</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../vnf-package/">VNF Packages</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../ns-descriptor/">Network Service Descriptor</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
                 
		
		
                  <li><ul> 
    
   
    <li class="subnav_drop"><span>VNF Managers</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../vnfm-intro/">VNFM intro</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../vnfm-generic/">Generic VNFM</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../vnfm-juju/">Juju VNFM</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../vnfm-how-to-write/">Develop a VNFM</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../vnfm-vendor-specific/">Integrate your own VNFM</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
                 
		
		
                  <li><ul> 
    
   
    <li class="subnav_drop"><span>Monitoring</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../monitoring/">Monitoring overview</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../zabbix-plugin/">Zabbix plugin</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
                 
		
		
                  <li><ul> 
    
   
    <li class="subnav_drop"><span>Autoscaling</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../autoscaling/">Autoscaling overview</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
                 
		
		
                  <li><ul> 
    
   
    <li class="subnav_drop"><span>Fault Management</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../fault-management/">FM overview</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
                 
		
		
                  <li><ul> 
    
   
    <li class="subnav_drop"><span>Network Slicing</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../network-slicing/">NS overview</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
                 
		
		
                  <li><ul> 
    
   
    <li class="subnav_drop"><span>Marketplace</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../marketplace/">Marketplace overview</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
                 
		
		
                  <li><ul> 
    
   
    <li class="subnav_drop"><span>Tutorials</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../tutorial/">Tutorials overview</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../dummy-NSR/">Dummy NSR</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../iperf-NSR/">Iperf Scenario</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../ims-NSR/">OpenIMSCore example</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../fms-sipp-tutorial/">Fault Management System</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../integration-test-use/">Integration Tests</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
                 
		
		
                  <li><ul> 
    
   
    <li class="subnav_drop"><span>Learn more</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../nfvo-architecture/">NFVO Architecture</a>
        
    </li>


        
             

    <li class="toctree-l1 current">
        <a class="current" href="./">Create a VIM Driver</a>
        
         
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../nfvo-sdk/">Open Baton SDKs</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../how-to-register-event/">The Event Mechanism tutorial</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
                 
		
		
                  <li><ul> 
    
   
    <li class="subnav_drop"><span>FAQ</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../FAQ/">FAQ</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
                 
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
              </ul>
            </div>
            &nbsp;
          </nav>
        </div>
    <div class="content_container">
        <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

         

          
                <div class="wy-nav-content">
                  <div class="rst-content">
                   
                    <div role="main">
                      <div class="section">
                        
                          <h1 id="create-vim-driver">Create Vim Driver</h1>
<p>This tutorial will give This project plugin-sdk contains modules that are needed to implement a plugin for OpenBaton system.</p>
<h2 id="how-does-this-work">How does this work?</h2>
<p>OpenBaton use the Remote Procedure Call (RPC) mechanism for implementing the Plugins. It offers an implementation of an interface that is used by the NFVO. </p>
<h2 id="requirements">Requirements</h2>
<p>Before you can start with developing your own Vim Driver you need to prepare your programming environment by installing/configuring the following requirements:</p>
<ul>
<li>JDK 7 (<a href="http://openjdk.java.net/install/">installation</a>)</li>
<li>Gradle (<a href="https://docs.gradle.org/current/userguide/installation.html">installation</a>)</li>
</ul>
<h3 id="create-a-new-project">Create a new project</h3>
<p>Once you have started the IDE, click on File -&gt; New -&gt; Project...</p>
<p>In this dialog click on Gradle on the left and select java in the main properties window in the middle.</p>
<p><img alt="dialog" src="../images/new_project_vim.png" /></p>
<p>Then click on next to go to the next window.</p>
<p>In the next dialog you need to define the GroupId, ArtifactId and the Version.
More information on the specific meaning can be found <a href="https://maven.apache.org/guides/mini/guide-naming-conventions.html">here</a>.</p>
<p><img alt="dialog" src="../images/new_project_vim_groupId.png" /></p>
<p>Continue with the next dialog.</p>
<p>In this dialog you need to specify which gradle you want to use.
It is recommend to use the default gradle wrapper.
Additionally you can enable the auto-import.</p>
<p><img alt="dialog" src="../images/new_project_vim_groupId1.png" /></p>
<p>Continue with the next dialog by clicking on Next.</p>
<p>In the last dialog, you need to define the project name and the project location.</p>
<p><img alt="dialog" src="../images/new_project_vim_groupId2.png" /></p>
<p>Once this is done you can click on Finish and continue with creating the Main Class.</p>
<h3 id="create-the-main-class">Create the Main Class</h3>
<p>Afterwards, you need to create the Main Class of the VIM driver which will be started in the end.
For doing so, right click on the root folder my-vim, then click on New -&gt; Directory and insert what is show below.</p>
<p><img alt="dialog" src="../images/new_project_vim_new_directory.png" /></p>
<p>Click on OK to continue.</p>
<p>Additionally you need to create a new package.
This is done by a right-click on the previously created directory java.
Click on New -&gt; Package.
Here you can define the package name.</p>
<p><img alt="dialog" src="../images/new_project_vim_new_package.png" /></p>
<p>Finally you can create your MyVim Class by clicking (right click) on the previously created package and click on New -&gt; Java Class.</p>
<p><img alt="dialog" src="../images/new_project_vim_new_class.png" /></p>
<p>Once you did all these steps, the initial project structure is created.
What we miss right now is the configuration of the gradle files to define and fetch dependencies we need for implementing the Vim driver.
This is described in later sections.</p>
<p>In order to create a VIM driver for OpenBaton system you need to add to your <em>build.gradle</em> file:</p>
<pre><code class="gradle">
group 'org.myplugin.example'
version '1.0-SNAPSHOT'

buildscript {
    repositories {
        mavenLocal()
        mavenCentral()
    }
    dependencies {
        classpath(&quot;org.springframework.boot:spring-boot-gradle-plugin:1.2.6.RELEASE&quot;)
    }
}

repositories {
    mavenCentral()
    /**
     * Only needed for openbaton snapshots dependencies
     */
    maven {
        url 'https://oss.sonatype.org/content/repositories/snapshots/'
    }
}

apply plugin: 'java'
apply plugin: 'maven'
apply plugin: 'spring-boot'


mainClassName = 'org.myplugin.example.Starter'


dependencies {
    compile 'org.openbaton:plugin-sdk:3.0.0'
    compile'org.springframework:spring-context:4.2.1.RELEASE'
}

</code></pre>

<h2 id="write-your-vim-driver">Write your Vim driver</h2>
<p>The Vim driver is a simple class extending one abstract class and using a Starter utility </p>
<h4 id="type-of-vim-instance">Type of Vim Instance</h4>
<p>OpenBaton provides a specific class for handling the <strong>openstack</strong> type or the <strong>test</strong> type thus these two types are supported. For all the other types a generic class will handle the communication between the NFVO and your plugin.</p>
<h3 id="implement-vimdriver">Implement VimDriver</h3>
<p>The <em>VimDriver</em> is an abastract class that contains tha basic functionalities that a Vim Instance has to provide. </p>
<p><em><strong>NOTE</strong></em>: If you want to implement a Monitoring plugin, then you need to implement the Abstract Class <em>MonitoringPlugin</em></p>
<p>Your <strong>MyVim</strong> class will implement the methods inherited from <em>VimDriver</em> that manages your Vim Instance:</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>List\&lt;NFVImage> listImages</td>
<td>Returns the list of Images</td>
</tr>
<tr>
<td>List\&lt;Server> listServer</td>
<td>Returns the list of Servers</td>
</tr>
<tr>
<td>List\&lt;Network> listNetworks</td>
<td>Returns the list of Network</td>
</tr>
<tr>
<td>List\&lt;DeploymentFlavour> listFlavors</td>
<td>Returns the list of DeploymentFlavour</td>
</tr>
<tr>
<td>Server launchInstanceAndWait</td>
<td>Creates a new Server</td>
</tr>
<tr>
<td>void deleteServerByIdAndWait</td>
<td>Removes the Server with id</td>
</tr>
<tr>
<td>Network createNetwork</td>
<td>Creates a new Network</td>
</tr>
<tr>
<td>Network getNetworkById</td>
<td>Returns the Network with id</td>
</tr>
<tr>
<td>Network updateNetwork</td>
<td>Updates a new Network</td>
</tr>
<tr>
<td>boolean deleteNetwork</td>
<td>Deletes the Network</td>
</tr>
<tr>
<td>Subnet createSubnet</td>
<td>Creates a new Subnet</td>
</tr>
<tr>
<td>Subnet updateSubnet</td>
<td>Updates the Subnet</td>
</tr>
<tr>
<td>boolean deleteSubnet</td>
<td>Deletes the Subnet</td>
</tr>
<tr>
<td>List\&lt;String> getSubnetsExtIds</td>
<td>Returns the list of SubnetsExtId</td>
</tr>
<tr>
<td>DeploymentFlavour addFlavor</td>
<td>Adds a new DeploymentFlavour</td>
</tr>
<tr>
<td>DeploymentFlavour updateFlavor</td>
<td>Updates the DeploymentFlavour</td>
</tr>
<tr>
<td>boolean deleteFlavor</td>
<td>Deletes the DeploymentFlavour</td>
</tr>
<tr>
<td>NFVImage addImage</td>
<td>Adds a new NFVImage</td>
</tr>
<tr>
<td>NFVImage updateImage</td>
<td>Updates the NFVImage</td>
</tr>
<tr>
<td>NFVImage copyImage</td>
<td>Copies the NFVImage</td>
</tr>
<tr>
<td>boolean deleteImage</td>
<td>Deletes the NFVImage</td>
</tr>
<tr>
<td>Quota getQuota</td>
<td>Returns the Quota</td>
</tr>
<tr>
<td>String getType</td>
<td>Returns the type</td>
</tr>
</tbody>
</table>
<p>An example of the class:</p>
<pre><code class="java">package org.myplugin.example;

import org.openbaton.catalogue.mano.common.DeploymentFlavour;
import org.openbaton.catalogue.nfvo.*;
import org.openbaton.exceptions.VimDriverException;
import org.openbaton.vim.drivers.interfaces.VimDriver;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.context.annotation.Scope;

import java.util.ArrayList;
import java.util.List;
import java.util.Set;

public class MyVim extends VimDriver{


    private Logger log = LoggerFactory.getLogger(this.getClass());

    @Override
    public Server launchInstance(VimInstance vimInstance, String name, String image, String flavor, String keypair, Set&lt;String&gt; network, Set&lt;String&gt; secGroup, String userData) throws RemoteException {
        // ...
    }

    @Override
    public String getType(VimInstance vimInstance) {
        // ...
    }

    @Override
    public List&lt;NFVImage&gt; listImages(VimInstance vimInstance) {
        // ...
    }

    public static void main(String[] args) {
        PluginStarter.registerPlugin(MyVim.class, &quot;my-type&quot;, &quot;broker-ip&quot;, 5672, 10);
    }
}
</code></pre>

<p>As you can notice, there is the need of a <em>main</em> method to start multiple instances of the plugin (in this example are 10, the last parameter).</p>
<h2 id="run-your-vim-driver-in-openbaton-environment">Run your Vim driver in OpenBaton environment</h2>
<p>Under the folder of your project <em>src/main/resources</em> you should create a file <strong>plugin.conf.properties</strong> and write the variable <strong>type = <em>the-vim-type</em></strong>.</p>
<p>The structure of your project should be like:</p>
<p><img alt="Vim driver structure" src="../images/vim_plugin_structure.png" /></p>
<p>Now you can run <strong>./gradlew build</strong> and Gradle will create the jar that you can find in the folder <em>build/libs/myPlugin-1.0-SNAPSHOT.jar</em>.</p>
<p>Once all these steps are done, you can copy and paste the <em>myPlugin-1.0-SNAPSHOT.jar</em> under the folder specified in the <em>openbaton.properties</em> (under <em>/etc/openbaton</em> folder) <strong>plugin-installation-dir</strong> property, as default path_to_NFVO/plugins.
The plugin sends the log messages to NFVO, the NFVO writes them into a log file. The path to this file can be set with nfvo.plugin.log.path properties in the /etc/openbaton/openbaton.properties. 
Congratulations you have your version of the interface for your Vim Instance that will be used by NFVO</p>
<h2 id="use-my-plugin">Use my plugin</h2>
<p>Once you copied the jar file into the right folder, either you need to (re)start the NFVO or you type <em>installPlugin</em> in the NFVO console passing the needed arguments. In case you restart the NFVO, the plugin will automatically register and you can see that there will be a log file in the NFVO folder called <em>plugin-myPlugin.log</em> containing the logs of the plugin. The myPlugin now acts as a normal plugin so for using it check out the <a href="../vim-instance/">Vim instance documentation</a> in order to point out to the new plugin.</p>
<p><strong>NOTE</strong>: you can also launch your plugin from your command line just typing</p>
<pre><code class="bash">$ java -jar myPlugin-1.0-SNAPSHOT.jar
</code></pre>

<!---
Script for open external links in a new tab
-->

<script type="text/javascript" charset="utf-8">
      // Creating custom :external selector
      $.expr[':'].external = function(obj){
          return !obj.href.match(/^mailto\:/)
                  && (obj.hostname != location.hostname);
      };
      $(function(){
        $('a:external').addClass('external');
        $(".external").attr('target','_blank');
      })
</script>
                        
                      </div>
                    </div>
                    <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../nfvo-sdk/" class="btn btn-neutral float-right" title="Open Baton SDKs"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../nfvo-architecture/" class="btn btn-neutral" title="NFVO Architecture"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright (c) 2016 Open Baton (http://www.openbaton.org)</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          	  
                  </div>
                </div>

        </section>
    </div>
  </div>
</div>



</body>
</html>

