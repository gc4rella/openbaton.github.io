<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <title>OpenBaton Documentation</title>
  

  <link rel="shortcut icon" href="favicon.ico">
  

  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:400italic,600italic,400,300,600,700" rel="stylesheet" type="text/css">

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "FM overview";
    var mkdocs_page_input_path = "fault-management.md";
    var mkdocs_page_url = "/fault-management/";
     var mkdocs_page_url = "/fault-management/";
  </script>
  
  <!-- site_name == OpenBaton Documentation -->
  <!-- page_title == FM overview -->
  <!-- base_url == .. -->
  <!-- current_page == FM overview - /fault-management/ [*]
 -->
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script>
  <script src="../js/theme.js"></script> 

  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-68429895-1', 'openbaton.github.io');
      ga('send', 'pageview');
  </script>
  

<style>

.subnav_drop{
  cursor: pointer;


}

ul.subnav {
/*display:none ;*/
cursor: pointer;
border-bottom: 1px solid #e1e1e5;
}

.subnav:last-child{
  border-bottom: none;

}

ul.subnav:active {
display:block;
}

.wy-menu-vertical li ul {
display: block;

  }

</style>
</head>

<body role="document">

<script type="text/javascript">
$( document).ready(function(){
      //console.log("test");

    //$('.subnav').not( ":has('FM overview')" ).hide();
    $('li.subnav_drop').find('ul.subnav').hide();
    //$('li.subnav_drop').find('ul.subnav').each(function(i,e){console.log(i,e)});
       $( ".subnav" ).find( "li:contains('FM overview')" ).each(function(i,e){
          var currentElement = $(e);
          currentElement.parent().css({"display":"block","visibility":"visible"}); //css("background-color","blue");
          currentElement.css({"display":"block","visibility":"visible"});
       });//$( ".subnav" ).find( "li:contains('FM overview')" ).css("display","block");
       //$(".current").css({"background-color":"blue","display":"block","visibility":"visible"});
       //show(1000,function(i,e){console.log(i,e)});
       //$('li.subnav_drop').find('ul.subnav').css("background-color","blue");
      //$(this).find('ul.subnav').toggle();
    $('li.subnav_drop').click(function(i,e) {  
      $('li.subnav_drop').not(this).find('ul.subnav').hide();
      $(this).find('ul.subnav').toggle();
    }); 

});
   
$( ".wy-nav-content" ).find( "li:contains('FM overview')" ).css('color','red');
console.log('--------');
console.log($( ".wy-nav-content" ).find( "div:contains('FM overview')" ).css("color","red"));
console.log('--------');
console.log($( ".subnav" ).find( "li:contains('FM overview')" ));
console.log('--------');
  </script>



<div class="navcontainer" style="margin:0px; background:#000;">
    <div class="navholder">
      <nav>
        <a href="../../index.html" class="logo"></a>
        <a href="#" id="menu-icon"></a>
        <ul class="navigation">
          
                <li><a href="../../index.html#about">About</a></li>
                <li><a href="../../cases.html">Use Cases</a></li>
                <li><a href="../../features.html">Features</a></li>
                <li><a href="#">Documentation</a></li>
                <li><a href="../../index.html#contact">Contact</a></li>
                <li><a href="http://marketplace.openbaton.org"><i class="material-icons">shopping_cart </i>  Marketplace<div class="ripple-container"></div></a></li>
          </ul>
      </nav>
     </div>
</div>
<div  class="container">
  <div class="holder"> 
        <div class="wy-grid-for-nav">

          
          <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
            <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
              <ul class="current">
                
		
                  <li><ul> 
    
   
    <li class="subnav_drop"><span>Get Started</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="..">Get Started</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
                 
		
		
                  <li><ul> 
    
   
    <li class="subnav_drop"><span>Installation</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../nfvo-installation/">Overview</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../nfvo-installation-deb/">Install on Linux</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../nfvo-installation-mac/">Install on MacOS</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../nfvo-installation-docker/">Install with Docker</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../nfvo-installation-vagrant/">Install with Vagrant</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../nfvo-configuration/">Configure it</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
                 
		
		
                  <li><ul> 
    
   
    <li class="subnav_drop"><span>NFV Orchestrator</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../use/">NFVO intro</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../security/">Identity management</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../nfvo-how-to-use-gui/">Use via the Dashboard</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../nfvo-how-to-use-cli/">Use via the CLI</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../vim-instance/">Register a PoP</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../vnf-package/">VNF Packages</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../ns-descriptor/">Network Service Descriptor</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
                 
		
		
                  <li><ul> 
    
   
    <li class="subnav_drop"><span>VIM Driver</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../vim-driver/">VIM Driver Overview</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
                 
		
		
                  <li><ul> 
    
   
    <li class="subnav_drop"><span>VNF Managers</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../vnfm-intro/">VNFM intro</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../vnfm-generic/">Generic VNFM</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../vnfm-juju/">Juju VNFM</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../vnfm-how-to-write/">Develop a VNFM</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../vnfm-vendor-specific/">Integrate your own VNFM</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
                 
		
		
                  <li><ul> 
    
   
    <li class="subnav_drop"><span>Monitoring</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../monitoring/">Monitoring overview</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../zabbix-plugin/">Zabbix plugin</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
                 
		
		
                  <li><ul> 
    
   
    <li class="subnav_drop"><span>Autoscaling</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../autoscaling/">Autoscaling overview</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
                 
		
		
                  <li><ul> 
    
   
    <li class="subnav_drop"><span>Fault Management</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 current">
        <a class="current" href="./">FM overview</a>
        
         
        
    </li>


        
</li>
</ul>
    
</ul></li>
                 
		
		
                  <li><ul> 
    
   
    <li class="subnav_drop"><span>Network Slicing</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../network-slicing/">NS overview</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
                 
		
		
                  <li><ul> 
    
   
    <li class="subnav_drop"><span>Marketplace</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../marketplace/">Marketplace overview</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
                 
		
		
                  <li><ul> 
    
   
    <li class="subnav_drop"><span>Tutorials</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../tutorial/">Tutorials overview</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../dummy-NSR/">Dummy NSR</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../iperf-NSR/">Iperf Scenario</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../tutorial-sipp/">SIPp example</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../ims-NSR/">OpenIMSCore example</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../tutorial-juju/">OpenIMSCore with Juju VNFM</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../fms-sipp-tutorial/">Fault Management System</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../integration-test-use/">Integration Tests</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
                 
		
		
                  <li><ul> 
    
   
    <li class="subnav_drop"><span>Learn more</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../nfvo-architecture/">NFVO Architecture</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../vim-driver-create/">Create a VIM Driver</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../nfvo-sdk/">Open Baton SDKs</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../how-to-register-event/">The Event Mechanism tutorial</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
                 
		
		
                  <li><ul> 
    
   
    <li class="subnav_drop"><span>FAQ</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../FAQ/">FAQ</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
                 
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
              </ul>
            </div>
            &nbsp;
          </nav>
        </div>
    <div class="content_container">
        <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

         

          
                <div class="wy-nav-content">
                  <div class="rst-content">
                   
                    <div role="main">
                      <div class="section">
                        
                          <h1 id="open-baton-fault-management-system-fms">Open Baton Fault Management System (FMS)</h1>
<p>The Open Baton FMS project is a module of the Open Baton Orchestrator. 
It provides an extensive Fault Management System that is based on alarms coming from the VIM and executes actions through the NFVO.<br />
<strong>Note</strong>: if you followed the installation guide using the bootstrap, you can jump to the section "How to use Open Baton FM"</p>
<h1 id="technical-requirements">Technical Requirements</h1>
<p>The technical requirements are:  </p>
<ul>
<li>Zabbix plugin running (see the <a href="https://github.com/openbaton/docs/blob/develop/docs/zabbix-plugin.md">doc of Zabbix plugin</a>)</li>
<li>Mysql server installed and running</li>
<li>Open Baton 3.2.x running</li>
<li>Generic VNFM 3.2.x running</li>
</ul>
<h1 id="how-to-install-open-baton-fm">How to install Open Baton FM</h1>
<p>Once the prerequisites are met, you need to execute the following steps.</p>
<h2 id="create-the-database">Create the database</h2>
<p>In order to create the database be sure you have installed <a href="http://dev.mysql.com/doc/refman/5.7/en/linux-installation.html">mysql server</a> as already mentioned in the requirements section. 
You need root access to mysql-server in order to create a new database called faultmanagement. Once you access into mysql, execute the following operation: </p>
<pre><code class="bash">create database faultmanagement;
</code></pre>

<p>Once the database has been created, you should create a user which will be used by the FM system to access and store data on the database. If you decide to use the <code>root</code> user you can skip this step, but you need to modify the fms.properties file accordingly as defined in the next section. 
By default username and password are set with the following values in the fms.properties properties file (see next section if you plan to use a different user and password): </p>
<ul>
<li>username=fmsuser</li>
<li>password=changeme</li>
</ul>
<p>Grant the access to the database "faultmanagement", to the user, running the following command:</p>
<pre><code class="bash">GRANT ALL PRIVILEGES ON faultmanagement.* TO fmsuser@'%' IDENTIFIED BY 'changeme';
</code></pre>

<h2 id="modify-fmsproperties-file-in-order-to-use-different-credentials-for-the-database">Modify fms.properties file in order to use different credentials for the database</h2>
<p>In the folder "etc" of this project, there is a file called fms.properties containing all the default properties values used by the FM system. </p>
<p>In order to use different credentials, you need to modify the following DB properties: </p>
<pre><code class="bash"># DB properties
spring.datasource.username=fmsuser
spring.datasource.password=changeme
</code></pre>

<p>In case your DB is running remotely, you can specifcy a different host, instead of localhost, in the following property (be careful to have port 3306 open and accessible from remote): </p>
<pre><code class="bash">spring.datasource.url=jdbc:mysql://localhost:3306/faultmanagement
</code></pre>

<h2 id="additional-configuration-options">Additional configuration options</h2>
<p>As already mentioned in the previous section, in the folder "etc" of this project, there is a file called fms.properties containing all the default properties values used by the FM system.
You should update this file in order to make it work with your NFVO instance. Change the Open Baton related properties section: </p>
<pre><code class="bash">################################################
####### Open Baton Related properties ##########
################################################
nfvo.ip=localhost
nfvo.port=8080
nfvo-usr=admin
nfvo-pwd=openbaton
</code></pre>

<h2 id="checkout-the-source-code-of-the-project-compile-and-run-it">Checkout the source code of the project, compile and run it</h2>
<p>You can clone this repository with this command:</p>
<pre><code class="bash">git clone https://github.com/openbaton/fm-system.git
</code></pre>

<p>The configuration file is etc/fms.properties, you have to copy it in the Open Baton etc folder ( /etc/openbaton ). You can do it typing the following command </p>
<pre><code class="bash">cd fm-system
cp etc/fms.properties /etc/openbaton/fms.properties
</code></pre>

<p>Now, you can finally compile and start the FM System. </p>
<pre><code class="bash">./fm-system.sh compile start
</code></pre>

<h1 id="how-to-use-open-baton-fm">How to use Open Baton FM</h1>
<p>Open Baton FM is a rule-driven tool. The rules define when to generate an alarm and how to react. The rule for generating the alarm is called fault management policy (see the next section). 
The rule for defining how to react upon alarms is a Drools Rule. Once such rules are in place, Open Baton FM follows the following workflow.</p>
<p><img alt="Fault management system use case" src="../images/fms-use-case.png" /></p>
<p>The actions are listed below:</p>
<table>
<thead>
<tr>
<th>ACTION</th>
<th>DESCRIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td>Heal</td>
<td>The VNFM executes the scripts in the Heal lifecycle event (in the VNFD). The message contains the cause of the fault, which can be used in the scripts.</td>
</tr>
<tr>
<td>Switch to stanby VNFC (Stateless)</td>
<td>If the VDU requires redoundancy active-passive, there will be a component VNFC<em> in standby mode. This action consists in: activate the VNFC</em>, route all signalling and data flow(s) for VNFC to VNFC*, deactivate VNFC.</td>
</tr>
<tr>
<td>Switch to stanby VNFC (Stateful)</td>
<td>To investigate. Refer on ETSI GS NFV-REL 001 v1.1.1 (2015-01) Chapter 11.2.1.</td>
</tr>
</tbody>
</table>
<h2 id="write-a-fault-management-policy">Write a fault management policy</h2>
<p>The fault management policy needs to be present in the VNFD, in particular in the VDU. This is an example of fault management policy:</p>
<pre><code class="json">&quot;fault_management_policy&quot;:[
    {
      &quot;name&quot;:&quot;web server not available&quot;,
      &quot;isVNFAlarm&quot;: true,
      &quot;criteria&quot;:[
      {
        &quot;parameter_ref&quot;:&quot;net.tcp.listen[80]&quot;,
        &quot;function&quot;:&quot;last()&quot;,
        &quot;vnfc_selector&quot;:&quot;at_least_one&quot;,
        &quot;comparison_operator&quot;:&quot;=&quot;,
        &quot;threshold&quot;:&quot;0&quot;
      }
      ],
      &quot;period&quot;:5,
      &quot;severity&quot;:&quot;CRITICAL&quot;
    }
]
</code></pre>

<p>You can find an example of the fault management policy for the <strong>TOSCA YAML descriptors</strong> <a href="../tosca-fm/">here</a>.</p>
<p>Description of the fault management policy:  </p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>This is the name of the fault management policy.</td>
</tr>
<tr>
<td>isVNFAlarm</td>
<td>True, if the alarm is of type VNF.</td>
</tr>
<tr>
<td>criteria</td>
<td>The criteria defines a threshold on a monitoring parameter. When the threshold is crossed an alarm is fired.</td>
</tr>
<tr>
<td>period</td>
<td>The criteria is checked every "period" seconds.</td>
</tr>
<tr>
<td>severity</td>
<td>Defines the severity of the alarm.</td>
</tr>
</tbody>
</table>
<p>Description of the criteria:  </p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>parameter_ref</td>
<td>This is the reference to a monitoring parameter in the VDU. (see below how to define monitoring parameters).</td>
</tr>
<tr>
<td>function</td>
<td>The function to apply to the parameter ( last(0) means the last value available of the parameter). Since currently only Zabbix is supported, look at the <a href="https://www.zabbix.com/documentation/2.2/manual/appendix/triggers/functions">Zabbix documentation</a> for the all available functions.</td>
</tr>
<tr>
<td>vnfc_selector</td>
<td>select if the criteria is met when all VNFC components cross the threshold (all) or at least one (at_least_one)</td>
</tr>
<tr>
<td>comparison_operator</td>
<td>This defines the comparison operator used for the threshold.</td>
</tr>
<tr>
<td>threshold</td>
<td>The value of the threshold to compare against the parameter_ref value.</td>
</tr>
</tbody>
</table>
<p>In order to refer to a monitoring parameter with the property <strong>parameter_ref</strong>, it needs to be present in the vdu:</p>
<pre><code class="json">&quot;monitoring_parameter&quot;:[
   &quot;agent.ping&quot;,

   &quot;net.tcp.listen[5001]&quot;,

   &quot;system.cpu.load[all,avg5]&quot;,

   &quot;vfs.file.regmatch[/var/log/app.log,Exception]&quot;
]
</code></pre>

<p>You can specify every parameter available in the <a href="https://www.zabbix.com/documentation/2.2/manual/config/items/itemtypes/zabbix_agent">Zabbix Agent</a>.</p>
<h2 id="how-the-heal-method-works">How the HEAL method works</h2>
<p>The Heal VNF operation is a method of the VNF lifecycle management interface described in the ETSI <a href="http://www.etsi.org/deliver/etsi_gs/NFV-MAN/001_099/001/01.01.01_60/gs_nfv-man001v010101p.pdf">NFV MANO</a> specifications. Here is reported the description and the notes about this method:</p>
<pre><code>Description: this operation is used to request appropriate correction actions in reaction to a failure.
Notes: This assumes operational behaviour for healing actions by VNFM has been described in the VNFD. An example might be switching between active and standby mode.
</code></pre>

<p>In the ETSI draft "NFV-IFA007v040" at <a href="https://docbox.etsi.org/isg/nfv/open/Drafts/IFA007_Or-Vnfm_ref_point_Spec/">this</a> page, the Heal VNF message is defined as:</p>
<pre><code>vnfInstanceId  : Identifies the VNF instance requiring a healing action. 
cause : Indicates the reason why a healing procedure is required. 
</code></pre>

<p>Once the fault management system received an alarm from the VIM, 
it checks, if the alarm is referred to a VNF and sends the Heal VNF message to the NFVO which forwards it to the respective VNFM.
The VNFM executes in the failed VNFC the scripts in the HEAL lifecycle event.
Here an example of the heal script you can use:</p>
<pre><code class="bash">#!/bin/bash

case &quot;$cause&quot; in

(&quot;serviceDown&quot;) 
    echo &quot;Apache is down, let's try to restart it...&quot;
    service apache2 restart
    if [ $? -ne 0 ]; then
        echo &quot;ERROR: the Apache service is not started&quot;
        exit 1
        fi
    echo &quot;The Apache service is running again!&quot;
    ;;
*) echo &quot;The cause $cause is unknown&quot;
    exit 2
    ;;
esac
</code></pre>

<p>The variable $cause is specified in the Drools rule. In our case it is "serviceDown" and we try to restart the Apache server.</p>
<h2 id="drools-rules">Drools Rules</h2>
<p>The Open Baton FMS is a rule-based system. Such rules are specified in Drools language and processed by the Drools engine in the Open Baton FMS.
An example rule looks like the following:</p>
<pre><code>rule &quot;Save a VNFAlarm&quot;
    when
        vnfAlarm : VNFAlarm()
    then
    VNFAlarm alarm = vnfAlarmRepository.save(vnfAlarm);
    logger.debug(&quot;Saved VnfAlarm: &quot;+alarm);
end
</code></pre>

<p>This rule saves a VNF Alarm in the database.
The following rule executes the HEAL action once a VNF Alarm is received:</p>
<pre><code>rule &quot;Got a critical VNF Alarm and execute the HEAL action&quot;

    when
       vnfAlarm : VNFAlarm(  alarmState == AlarmState.FIRED, perceivedSeverity == PerceivedSeverity.CRITICAL)
    then

    //Get the vnfr
    VirtualNetworkFunctionRecord vnfr = nfvoRequestorWrapper.getVirtualNetworkFunctionRecord(vnfAlarm.getVnfrId());

    //Get the vnfc failed (assuming only one vnfc is failed)
    VNFCInstance vnfcInstance = nsrManager.getVNFCInstanceFromVnfr(vnfr,vnfAlarm.getVnfcIds().iterator().next());

    logger.info(&quot;(VNF LAYER) A CRITICAL alarm is received by the vnfc: &quot;+vnfcInstance.getHostname());

    //Get the vdu of the failed VNFC
    VirtualDeploymentUnit vdu = nfvoRequestorWrapper.getVDU(vnfr,vnfcInstance.getId());

    logger.info(&quot;Heal fired!&quot;);
    highAvailabilityManager.executeHeal(&quot;serviceDown&quot;,vnfr.getParent_ns_id(),vnfr.getId(),vdu.getId(),vnfcInstance.getId());

    //Insert a new recovery action

    RecoveryAction recoveryAction= new RecoveryAction(RecoveryActionType.HEAL,vnfr.getEndpoint(),&quot;&quot;);
    recoveryAction.setStatus(RecoveryActionStatus.IN_PROGRESS);
    insert(recoveryAction);
end
</code></pre>

<h2 id="how-the-switch-to-standby-works">How the Switch to Standby works</h2>
<p>The Switch to Standby action can be performed by the Open Baton FMS once a VNFC in standby is present in the VNF. Its main action is switch the service from a VNFC to the VNFC in standby automatically.
In order to have a VNFC in standby, such information must be included in the VNFD, in particular in the VDU, as the following:</p>
<pre><code>&quot;high_availability&quot;:{
    &quot;resiliencyLevel&quot;:&quot;ACTIVE_STANDBY_STATELESS&quot;,
    &quot;redundancyScheme&quot;:&quot;1:N&quot;
}
</code></pre>

<p>This information will be processed by the Open Baton FMS which will create a VNFC instance in standby.
Then in a Drools rule this action can be called as following:</p>
<pre><code>highAvailabilityManager.switchToRedundantVNFC(failedVnfcInstance,vnfr,vdu);
</code></pre>

<h2 id="tutorial">Tutorial</h2>
<p>The tutorial is available at this <a href="../fms-sipp-tutorial/">page</a>. </p>
                        
                      </div>
                    </div>
                    <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../network-slicing/" class="btn btn-neutral float-right" title="NS overview">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../autoscaling/" class="btn btn-neutral" title="Autoscaling overview"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright (c) 2016 Open Baton (http://www.openbaton.org)</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          	  
                  </div>
                </div>

        </section>
    </div>
  </div>
</div>



</body>
</html>

